# Task 1

## Kube Prometheus Stack Components

### Highly available Prometheus

Efficiently gathers and stores metrics as time series data.

### Prometheus Orchestrator

Simplifies the setup and configuration of Prometheus, Alertmanager, and other monitoring components.

### Redundant Alertmanager

Effectively manages alerts received from clients, including features like grouping, inhibition, and silences.

### Prometheus Node Exporter

Exports OS and hardware metrics to Prometheus for monitoring.

### Prometheus Adapter for Kubernetes Metrics APIs

A service exposing Prometheus metrics as a metrics API, enhancing monitoring capabilities.

### Prometheus Blackbox Exporter

Generates metrics based on response times of internal or external endpoints, including HTTP, HTTPS, ICMP, DNS, TCP.

### Grafana

Facilitates visualization, querying, and alerting on data from various sources.

### Kubernetes State Metrics

A daemon monitoring the Kubernetes API server and providing metrics on the state of objects.

## Helm Charts

```bash
kubectl get po,sts,svc,pvc,cm
```
```bash
NAME                                                       READY   STATUS    RESTARTS   AGE
pod/alertmanager-helm-app-python-prom-ku-alertmanager-0    2/2     Running   0          25m
pod/app-python-1                                           1/1     Running   0          1h
pod/app-python-0                                           1/1     Running   0          1h
pod/app-python-prom-grafana-ef887c1550-0461b               3/3     Running   0          25m
pod/app-python-prom-ku-operator-76364b96f-bfb0d            1/1     Running   0          25m
pod/app-python-prom-kube-state-metrics-0cb148c-a2b84       1/1     Running   0          25m
pod/app-python-prom-prometheus-node-exporter-d1f8b         1/1     Running   0          25m
pod/prometheus-helm-app-python-prom-ku-prometheus-0        2/2     Running   0          25m
```
### Stateful Sets and Services
```bash 
NAME                                                                  READY   AGE
statefulset.apps/alertmanager-helm-app-python-prom-ku-alertmanager    1/1     25m
statefulset.apps/app-python                                          2/2     1h
statefulset.apps/prometheus-helm-app-python-prom-ku-prometheus        1/1     25m
```
### Network-Exposing Services

```bash
NAME                                            TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
service/alertmanager-operated                  ClusterIP      None             <none>        9093/TCP,9094/TCP,9094/UDP   25m
service/kubernetes                             ClusterIP      10.96.0.3        <none>        443/TCP                      1h
service/app-python                             LoadBalancer   10.97.9.60       <pending>     8080:32238/TCP               1h
service/app-python-prom-grafana                ClusterIP      10.105.131.196   <none>        80/TCP                       25m
service/app-python-prom-ku-alertmanager        ClusterIP      10.97.195.6      <none>        9093/TCP,8080/TCP            25m
service/app-python-prom-ku-operator            ClusterIP      10.105.187.12    <none>        443/TCP                      25m
service/app-python-prom-ku-prometheus          ClusterIP      10.110.156.208   <none>        9090/TCP,8080/TCP            25m
service/app-python-prom-kube-state-metrics     ClusterIP      10.110.73.137    <none>        8080/TCP                     25m
service/app-python-prom-prometheus-node-exporter  ClusterIP   10.109.116.238   <none>        9100/TCP                     25m
service/prometheus-operated                    ClusterIP      None             <none>        9090/TCP                     25m
```

### Volumes

```bash
NAME                                              STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/data-app-python-0          Bound    pvc-17144399-621c-437f-a404-ecab5b5f454c   1Gi        RWO            standard       1h
persistentvolumeclaim/data-app-python-1          Bound    pvc-450b754b-d69f-4d83-a2d8-12c38eb70381   1Gi        RWO            standard       1h
```

### Configuration maps

```bash
NAME                                                      DATA   AGE
configmap/app-python-config-map                           1      1h
configmap/kube-root-ca.crt                                 1      1h
configmap/app-python-prom-grafana                          1      25m
configmap/app-python-prom-grafana-config-dashboards        1      25m
configmap/app-python-prom-ku-alertmanager-overview         1      25m
configmap/app-python-prom-ku-apiserver                     1      25m
configmap/app-python-prom-ku-cluster-total                 1      25m
configmap/app-python-prom-ku-controller-manager            1      25m
configmap/app-python-prom-ku-etcd                          1      25m
configmap/app-python-prom-ku-grafana-datasource            1      25m
configmap/app-python-prom-ku-grafana-overview              1      25m
configmap/app-python-prom-ku-k8s-coredns                   1      25m
configmap/app-python-prom-ku-k8s-resources-cluster         1      25m
configmap/app-python-prom-ku-k8s-resources-multicluster    1      25m
configmap/app-python-prom-ku-k8s-resources-namespace       1      25m
configmap/app-python-prom-ku-k8s-resources-node            1      25m
configmap/app-python-prom-ku-k8s-resources-pod             1      25m
configmap/app-python-prom-ku-k8s-resources-workload        1      25m
configmap/app-python-prom-ku-k8s-resources-workloads-namespace  1    25m
configmap/app-python-prom-ku-kubelet                      1      25m
configmap/app-python-prom-ku-namespace-by-pod             1      25m
configmap/app-python-prom-ku-namespace-by-workload        1      25m
configmap/app-python-prom-ku-node-cluster-rsrc-use        1      25m
configmap/app-python-prom-ku-node-rsrc-use                1      25m
configmap/app-python-prom-ku-nodes                        1      25m
configmap/app-python-prom-ku-nodes-darwin                 1      25m
configmap/app-python-prom-ku-persistentvolumesusage       1      25m
configmap/app-python-prom-ku-pod-total                    1      25m
configmap/app-python-prom-ku-prometheus                   1      25m
configmap/app-python-prom-ku-proxy                        1      25m
configmap/app-python-prom-ku-scheduler                    1      25m
configmap/app-python-prom-ku-workload-total               1      25m
configmap/prometheus-app-python-prom-ku-prometheus-rulefiles-0  35  25m
```

## Grafana Dashboards

### CPU and Memory Consumption of Your StatefulSet
CPU consumption is ~0.017
Memory consumption is ~68 MiB
### Pods with Higher and Lower CPU Usage in the Default Namespace
Highest Pod: prometheus-helm-app-python-prom-ku-prometheus-0 (0.022)
Lowest Pod: alertmanager-helm-app-python-prom-ku-alertmanager-0 (0.0011)
### Node Memory Usage in Percentage and Megabytes
Memory usage is 48.2% (~6.8 GiB)

### Number of Pods and Containers Managed by the Kubelet Service
17 pods and 22 containers

### Network Usage of Pods in the Default Namespace
Received: 36.2 kB/s
Transmitted: 27.4 kB/s
### Number of Active Alerts
Answer: 7

## Task 2

```bash
kubectl get po
NAME                                                        READY   STATUS    RESTARTS   AGE
pod/alertmanager-helm-app-python-prom-ku-alertmanager-0     2/2     Running   0          9h
pod/app-python-1                                            1/1     Running   0          58m
pod/app-python-0                                            1/1     Running   0          58m
pod/app-python-prom-grafana-ef887c1550-0461b                3/3     Running   0          9h
pod/app-python-prom-ku-operator-76364b96f-bfb0d             1/1     Running   0          9h
pod/app-python-prom-kube-state-metrics-0cb148c-a2b84        1/1     Running   0          9h
pod/app-python-prom-prometheus-node-exporter-d1f8b          1/1     Running   0          9h
pod/prometheus-helm-app-python-prom-ku-prometheus-0         2/2     Running   0          9h
kubectl exec app-python-0 -- cat /output-dir/out.html
Defaulted container "app-python" out of: app-python, install (init)
<!doctype html>
<html>
  <head>
    <title>Example Domain</title>

    <meta charset="utf-8" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type="text/css">
      body {
        background-color: #f0f0f2;
        margin: 0;
        padding: 0;
        font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI",
          "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
      }
      div {
        width: 600px;
        margin: 5em auto;
        padding: 2em;
        background-color: #fdfdff;
        border-radius: 0.5em;
        box-shadow: 2px 3px 7px 2px rgba(0, 0, 0, 0.02);
      }
      a:link,
      a:visited {
        color: #38488f;
        text-decoration: none;
      }
      @media (max-width: 700px) {
        div {
          margin: 0 auto;
          width: auto;
        }
      }
    </style>
  </head>

  <body>
    <div>
      <h1>Example Domain</h1>
      <p>
        This domain is for use in illustrative examples in documents. You may
        use this domain in literature without prior coordination or asking for
        permission.
      </p>
      <p>
        <a href="https://www.iana.org/domains/example">More information...</a>
      </p>
    </div>
  </body>
</html>
```